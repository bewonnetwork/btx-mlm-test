<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>BTX.ONE ‚Äì Upgrade / Investment (Demo)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    *{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system,"Segoe UI",sans-serif}
    body{
      min-height:100vh;
      background:radial-gradient(circle at top,#020617,#020617 60%);
      color:#e5f0ff;
      padding:16px;
    }
    a{color:#38bdf8;text-decoration:none}
    .shell{max-width:520px;margin:0 auto;}

    .top-header{
      display:flex;
      align-items:center;
      gap:10px;
      margin-bottom:12px;
    }
    .top-header img{
      width:46px;height:46px;border-radius:999px;
      object-fit:cover;
      box-shadow:0 0 24px rgba(59,130,246,.95);
    }
    .top-header h1{
      font-size:18px;
      letter-spacing:.18em;
      text-transform:uppercase;
    }
    .top-header p{
      font-size:11px;
      color:#9ca3af;
      margin-top:2px;
    }

    .card{
      position:relative;
      border-radius:26px;
      padding:16px 16px 18px;
      background:linear-gradient(135deg,rgba(15,23,42,.98),rgba(30,64,175,.96));
      box-shadow:
        0 0 0 2px rgba(56,189,248,.7),
        0 26px 70px rgba(0,0,0,.9);
      overflow:hidden;
    }
    .glow{
      position:absolute;inset:-90px;
      background:
        radial-gradient(circle at 0 0,rgba(56,189,248,.25),transparent 60%),
        radial-gradient(circle at 100% 100%,rgba(74,222,128,.25),transparent 60%);
      opacity:.9;pointer-events:none;
    }
    .inner{position:relative;z-index:1;}

    .summary{
      border-radius:16px;
      padding:10px 12px;
      background:rgba(15,23,42,.96);
      box-shadow:0 0 0 1px rgba(148,163,184,.5);
      font-size:12px;
      margin-bottom:10px;
    }
    .summary h2{
      font-size:14px;
      margin-bottom:6px;
    }
    .row{
      display:flex;
      justify-content:space-between;
      margin-bottom:2px;
    }
    .row span:first-child{color:#9ca3af;}

    .badge{
      display:inline-flex;
      margin-top:6px;
      padding:3px 10px;
      border-radius:999px;
      font-size:10px;
      letter-spacing:.12em;
      text-transform:uppercase;
      border:1px solid rgba(74,222,128,.7);
      color:#bbf7d0;
      background:rgba(22,163,74,.25);
    }
    .badge-free{
      border-color:rgba(248,250,252,.6);
      background:rgba(15,23,42,.9);
      color:#e5e7eb;
    }

    form{
      margin-top:10px;
      font-size:12px;
    }
    label{
      display:block;
      margin-bottom:4px;
      color:#e5e7eb;
    }
    .field{
      border-radius:999px;
      padding:7px 11px;
      background:rgba(15,23,42,1);
      box-shadow:0 0 0 1px rgba(148,163,184,.7);
      margin-bottom:8px;
    }
    .field input{
      width:100%;
      border:none;
      outline:none;
      background:transparent;
      color:#e5f0ff;
      font-size:13px;
    }

    .btn-main{
      margin-top:4px;
      width:100%;
      border:none;
      border-radius:999px;
      padding:9px 16px;
      font-size:12px;
      text-transform:uppercase;
      letter-spacing:.18em;
      cursor:pointer;
      background:linear-gradient(135deg,#4ade80,#22c55e);
      color:#022c22;
      box-shadow:0 18px 46px rgba(34,197,94,.95);
    }
    .btn-main:disabled{
      opacity:.5;
      cursor:not-allowed;
      box-shadow:none;
    }

    .actions{
      display:flex;
      gap:8px;
      margin-top:10px;
      flex-wrap:wrap;
    }
    .btn-link{
      border-radius:999px;
      padding:6px 12px;
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.16em;
      border:1px solid rgba(148,163,184,.7);
      background:rgba(15,23,42,.9);
      color:#e5e7eb;
      cursor:pointer;
    }

    .note{
      margin-top:8px;
      font-size:10px;
      color:#9ca3af;
      line-height:1.4;
    }
    .highlight{
      color:#bbf7d0;
    }

    @media(max-width:640px){
      body{padding:10px;}
    }
  </style>
</head>
<body>
  <div class="shell">
    <header class="top-header">
      <img src="images/logo.png" alt="BTX Logo">
      <div>
        <h1>BTX.ONE</h1>
        <p>Account Upgrade / Investment (Demo)</p>
      </div>
    </header>

    <section class="card">
      <div class="glow"></div>
      <div class="inner">

        <!-- SUMMARY -->
        <div class="summary">
          <h2 id="uName">Member</h2>
          <div class="row">
            <span>Username</span>
            <span id="uUser">@user</span>
          </div>
          <div class="row">
            <span>Current Balance</span>
            <span id="uBalance">$0.00</span>
          </div>
          <div class="row">
            <span>Total Investment</span>
            <span id="uInvest">$0.00</span>
          </div>
          <div class="row">
            <span>Sponsor</span>
            <span id="uSponsor">N/A</span>
          </div>
          <span id="uBadge" class="badge badge-free">Free Member</span>
        </div>

        <!-- UPGRADE FORM -->
        <form id="upgradeForm">
          <label>Investment Amount (USDT)</label>
          <div class="field">
            <input id="amount" type="number" min="1" step="0.01" placeholder="Example: 100" required />
          </div>

          <button type="submit" id="btnUpgrade" class="btn-main">
            UPGRADE / INVEST NOW
          </button>
        </form>

        <div class="actions">
          <button class="btn-link" onclick="goDashboard()">Dashboard</button>
          <button class="btn-link" onclick="goHome()">Home</button>
        </div>

        <p class="note">
          üí° Rule (demo): ‡¶Ü‡¶™‡¶®‡¶ø ‡¶Ø‡ßá amount ‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡¶¨‡ßá‡¶®,
          <span class="highlight">‡ß´% ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ sponsor-‡¶è‡¶∞ Direct Commission</span> ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶Ø‡ßã‡¶ó ‡¶π‡¶¨‡ßá,
          ‡¶Ü‡¶∞ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ <span class="highlight">Total Investment</span> ‡¶è‡¶¨‡¶Ç <span class="highlight">Membership = Premium</span> ‡¶π‡ßü‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá‡•§
          ‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ wallet balance ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßá ‡¶®‡¶ø‡¶®‡•§
        </p>

      </div>
    </section>
  </div>

  <script>
    const STORAGE_USERS   = "btx_users_v1";
    const STORAGE_CURRENT = "btx_current_user_v1";

    function loadUsers(){
      const raw = localStorage.getItem(STORAGE_USERS);
      if(!raw) return [];
      try{return JSON.parse(raw);}catch(e){return [];}
    }
    function saveUsers(list){
      localStorage.setItem(STORAGE_USERS, JSON.stringify(list));
    }
    function getCurrentUser(){
      const raw = localStorage.getItem(STORAGE_CURRENT);
      if(!raw) return null;
      try{return JSON.parse(raw);}catch(e){return null;}
    }
    function saveCurrentUser(u){
      localStorage.setItem(STORAGE_CURRENT, JSON.stringify(u));
    }

    function goDashboard(){
      window.location.href = "dashboard.html";
    }
    function goHome(){
      window.location.href = "index.html";
    }

    let me = getCurrentUser();
    if(!me){
      alert("Please login first.");
      window.location.href = "login.html";
    }

    // PAGE INIT
    (function init(){
      // fresh users list & my record sync
      let users = loadUsers();
      const idx = users.findIndex(u=>u.id === me.id);
      if(idx >= 0){
        me = users[idx];
        saveCurrentUser(me);
      }

      document.getElementById("uName").textContent =
        me.fullName || me.username || "Member";
      document.getElementById("uUser").textContent =
        "@" + (me.username || "");
      document.getElementById("uBalance").textContent =
        "$" + (me.balance || 0).toFixed(2);
      document.getElementById("uInvest").textContent =
        "$" + (me.depositTotal || 0).toFixed(2);
      document.getElementById("uSponsor").textContent =
        me.sponsor_username || me.refCode || "N/A";

      const badge = document.getElementById("uBadge");
      if(me.membershipType === "premium"){
        badge.textContent = "Premium Member";
        badge.classList.remove("badge-free");
      }else{
        badge.textContent = "Free Member";
        badge.classList.add("badge-free");
      }
    })();

    // FORM SUBMIT
    document.getElementById("upgradeForm").addEventListener("submit", function(e){
      e.preventDefault();
      const btn = document.getElementById("btnUpgrade");
      const amtRaw = document.getElementById("amount").value;
      let amount = parseFloat(amtRaw || "0");
      if(isNaN(amount) || amount <= 0){
        alert("Valid investment amount ‡¶¶‡¶ø‡¶® (USDT).");
        return;
      }

      // latest data
      let users = loadUsers();
      const idx = users.findIndex(u=>u.id === me.id);
      if(idx < 0){
        alert("User data ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø (demo).");
        return;
      }
      me = users[idx];

      const balance = me.balance || 0;
      if(balance < amount){
        alert("Your wallet balance ‡¶ï‡¶Æ ‡¶Ü‡¶õ‡ßá‡•§ ‡¶Ü‡¶ó‡ßá deposit ‡¶¶‡¶ø‡ßü‡ßá balance ‡¶¨‡¶æ‡ßú‡¶æ‡¶®‡•§");
        return;
      }

      btn.disabled = true;

      // 1) member ‡¶è‡¶∞ balance ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡¶æ‡¶ü‡¶¨‡ßã
      me.balance      = balance - amount;
      me.depositTotal = (me.depositTotal || 0) + amount;
      me.membershipType = "premium";

      // 2) sponsor 5% direct commission
      const sponsorUsername = (me.sponsor_username || me.refCode || "").toLowerCase();
      if(sponsorUsername){
        const sIdx = users.findIndex(u=>(u.username || "").toLowerCase() === sponsorUsername);
        if(sIdx >= 0){
          const sponsor = users[sIdx];
          const bonus   = amount * 0.05; // 5%
          sponsor.directIncome = (sponsor.directIncome || 0) + bonus;
          sponsor.balance      = (sponsor.balance || 0) + bonus; // sponsor wallet ‡¶è ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶ø
          users[sIdx] = sponsor;
        }
      }

      // list & current user save
      users[idx] = me;
      saveUsers(users);
      saveCurrentUser(me);

      // UI update
      document.getElementById("uBalance").textContent =
        "$" + me.balance.toFixed(2);
      document.getElementById("uInvest").textContent =
        "$" + me.depositTotal.toFixed(2);

      const badge = document.getElementById("uBadge");
      badge.textContent = "Premium Member";
      badge.classList.remove("badge-free");

      alert("‚úÖ Investment / ID Update successful (demo). ‡¶è‡¶ñ‡¶® Dashboard ‡¶è ‡¶ó‡¶ø‡¶Ø‡¶º‡ßá balance ‡¶ì income ‡¶¶‡ßá‡¶ñ‡ßá ‡¶®‡¶ø‡¶®‡•§");
      btn.disabled = false;
      document.getElementById("amount").value = "";
    });
  </script>
</body>
</html>
